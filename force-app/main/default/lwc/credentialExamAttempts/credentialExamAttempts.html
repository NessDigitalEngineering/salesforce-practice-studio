<template>
    <lightning-card title={title}>
        <template if:true={emptyRecords}>
            <div class="slds-var-p-around_small slds-scrollable_y  setHeight">
                <table aria-describedby="" class="slds-table">
                    <thead></thead>
                    <tbody>
                        <template for:each={searchRecords} for:item="cred" for:index="index">
                            <tr class="slds-hint-parent" key={cred.Id}>
                                <th></th>
                                <td data-label="Credentials">

                                    <lightning-layout class="slds-box " vertical-align="center" horizontal-align="left"
                                        multiple-rows="true">
                                        <lightning-layout-item flexibility="auto" size="4" large-device-size="4"
                                            medium-device-size="4" small-device-size="4">
                                            <p class="slds-text-title_bold" title={label.ExamAttemptID}>
                                                {label.ExamAttemptID}
                                            </p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="no-flex" size="4" large-device-size="4"
                                            medium-device-size="4" small-device-size="4">
                                            <p class="slds-text-title_bold">{cred.Name} </p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="auto" size="4" large-device-size="4"
                                            medium-device-size="4" small-device-size="4">
                                            <template if:true={cred.showButton}>
                                                <div class="">
                                                    <button
                                                        class="slds-button slds-button_brand  slds-button_stretch exambtn"
                                                        value={cred.Id} data-status={cred.buttonName}
                                                        data-name={cred.Name} data-credentialname={cred.Credential__c}
                                                        data-examdate={cred.Exam_Date_Time__c}
                                                        onclick={handleClick}>{cred.buttonName}
                                                    </button>
                                                </div>
                                            </template>
                                        </lightning-layout-item>

                                        <lightning-layout-item flexibility="auto" size="4" large-device-size="4"
                                            medium-device-size="4" small-device-size="4">
                                            <p class="slds-truncate" title={label.User_Credential}>
                                                {label.User_Credential}</p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="no-flex" size="5" large-device-size="5"
                                            medium-device-size="5" small-device-size="5">
                                            <p class="slds-truncate">{cred.User_Credential__r.Name}</p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="auto" size="4" large-device-size="4"
                                            medium-device-size="4" small-device-size="4">
                                            <p class="slds-truncate" title={label.Credential_Name}>
                                                {label.Credential_Name}</p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="no-flex" size="5" large-device-size="5"
                                            medium-device-size="5" small-device-size="5">
                                            <p class="slds-truncate">{cred.Credential__c}</p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="auto" size="4" large-device-size="4"
                                            medium-device-size="4" small-device-size="4">
                                            <p class="slds-truncate" title={label.Exam_Date_Time}>{label.Exam_Date_Time}
                                            </p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="no-flex" size="5" large-device-size="5"
                                            medium-device-size="5" small-device-size="5">
                                            <p class="slds-truncate">
                                                <template if:false={cred.editExamDate}>
                                                    <lightning-formatted-date-time value={cred.Exam_Date_Time__c}
                                                        time-zone={timeZone} year="numeric" month="numeric"
                                                        day="numeric">
                                                    </lightning-formatted-date-time>&nbsp;
                                                    <lightning-button-icon icon-name="utility:edit" value={cred.Id}
                                                        input-type="date" onclick={handleDateEdit} size="x-small">
                                                    </lightning-button-icon>
                                                </template>

                                                <template if:true={cred.editExamDate}>
                                                    <lightning-input type="date" name={cred.Id} data-name={cred.Id}
                                                        value={cred.Exam_Date_Time__c}>
                                                    </lightning-input>
                                                </template>

                                            </p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="no-flex" size="3" large-device-size="3"
                                            medium-device-size="3" small-device-size="3">
                                            <p class="slds-truncate slds-p-left_small setMarginTop editDate">
                                                <template if:true={cred.editExamDate}>

                                                    <lightning-button-icon icon-name="action:check" name={cred.Id}
                                                        value={cred.Id} onclick={handleActionCheck} size="x-small">
                                                    </lightning-button-icon>
                                                    &nbsp;
                                                    <lightning-button-icon icon-name="action:remove" value={cred.Id}
                                                        onclick={handleActionClose} size="x-small">
                                                    </lightning-button-icon>
                                                </template>

                                            </p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="auto" size="4" large-device-size="4"
                                            medium-device-size="4" small-device-size="4">
                                            <p class="slds-truncate" title={label.Status}>{label.Status}</p>
                                        </lightning-layout-item>
                                        <lightning-layout-item flexibility="no-flex" size="5" large-device-size="5"
                                            medium-device-size="5" small-device-size="5">
                                            <p class="slds-truncate">{cred.Status__c}</p>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
            <template if:true={isShowExamModal}>
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                    aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <!-- modal header start -->
                        <header class="slds-modal__header">
                            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                                title="Close" onclick={hideModalBox}>
                                <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse"
                                    size="small"></lightning-icon>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                            <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate"> Exam Schedule
                            </h2>
                        </header>

                        <!-- modal body start -->
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                            <lightning-layout multiple-rows="true">
                                <lightning-layout-item size="12" padding="around-small" small-device-size="9"
                                    medium-device-size="6" large-device-size="6">
                                    <label class="credlabel"> {label.Exam_Attempt_Id}</label>
                                    <lightning-input name="credential" value={examname} class="creds" disabled>
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item size="12" padding="around-small" small-device-size="9"
                                    medium-device-size="6" large-device-size="6">
                                    <h6 class="headerText">
                                        <span class="abbr">*</span> {label.Exam_DateTime}
                                    </h6>
                                    <lightning-input variant="label-hidden" class="validate" type="datetime" required
                                        date-style="short" value={examdate} onchange={handleDateChange}
                                        data-id="validate">
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item size="12" padding="around-small" small-device-size="9"
                                    medium-device-size="6" large-device-size="6">
                                    <label class="nameLabel"> {label.Credential_Name} </label>
                                    <lightning-input class="validates" value={credentialName} disabled>
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item size="12" padding="around-small" small-device-size="9"
                                    medium-device-size="6" large-device-size="6">
                                    <h6 class="headerText1"> <span class="abbr">*</span> Reciept
                                        <lightning-helptext class="i-button" content='Please upload your exam reciept'>
                                        </lightning-helptext>
                                    </h6>

                                    <c-upload-file onupload={handleUploadFiles} examid={examname}
                                        credname={credentialName} isfile={isChangeFileName}></c-upload-file>
                                    <!--  <lightning-input type="file" multiple class="fup" 
                                    accept=".docx, .pdf, .jpg, .txt, .png, .csv, .html, .zip"
                                    onchange={handleFileUploaded} data-id ="validate">
                                </lightning-input>

                                <div class="slds-m-around_small pill">
                                    <template if:true={filesDatas}>
                                        <template for:each={filesDatas} for:item="file" for:index="index">
                                            <lightning-pill key={file.fileName} label={file.fileName} data-id={index}
                                                onclick={removeReceiptImage}></lightning-pill>
                                        </template>
                                    </template>

                                </div>-->



                                </lightning-layout-item>
                            </lightning-layout>
                        </div>

                        <footer class="slds-modal__footer">
                            <lightning-button class="button" variant="neutral" label="Cancel" onclick={hideModalBox}>
                            </lightning-button>
                            <lightning-button variant="brand" label="Save" onclick={saveRecord}>
                            </lightning-button>
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </template>
            <!-- Upload Result Modal PopUp -->
            <template if:true={displayUploadResultModal}>
                <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01"
                    class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container containerHeight">
                        <div class="slds-modal__header">
                            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                                title="Close" onclick={closeModal}>
                                <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse"
                                    size="small">
                                </lightning-icon>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                            <h2 class="slds-text-heading_medium slds-hyphenate">
                                {label.Upload_Result}</h2>

                        </div>
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-14">


                            <template if:true={showSpinner}>
                                <lightning-spinner alternative-text="Saving"></lightning-spinner>
                            </template>
                            <lightning-layout multiple-rows="true">
                                <lightning-layout-item size="12" padding="around-small" small-device-size="9"
                                    medium-device-size="6" large-device-size="6">
                                    <lightning-input class="" name="credential" value={examname}
                                        label={label.ExamAttemptID} disabled>
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item size="12" padding="around-small" small-device-size="9"
                                    medium-device-size="6" large-device-size="6">
                                    <lightning-input class="" name="credential" value={credentialName}
                                        label={label.Credential_Name} disabled>
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item size="12" padding="around-small" small-device-size="9"
                                    medium-device-size="6" large-device-size="6">

                                    <h6 class="headerText2 slds-p-bottom_xxx-small">
                                        <span class="abbr">*</span> {label.Exam_DateTime}
                                    </h6>
                                    <lightning-input class="slds-p-top_large" type="datetime" date-style="short"
                                        value={examDate} variant="label-hidden" label="Exam DateTime">
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item size="12" padding="around-small" small-device-size="9"
                                    medium-device-size="6" large-device-size="6">

                                    <h6 class="headerText4 slds-p-bottom_xxx-small">
                                        <span class="abbr ">*</span> {label.Status}
                                    </h6>

                                    <lightning-combobox value={value} placeholder="Select Result" options={options}
                                        onchange={handleresult} class="status">
                                    </lightning-combobox>

                                </lightning-layout-item>
                                <lightning-layout-item size="12" padding="around-small" small-device-size="9"
                                    medium-device-size="6" large-device-size="6">
                                    <h6 class="headerText1 slds-p-top_large"> <span class="abbr">*</span> Scorecard
                                        <lightning-helptext class="i-button"
                                            content='Please Upload Pass or Fail Scoreboard'>
                                        </lightning-helptext>
                                    </h6>
                                    <c-upload-file onupload={handleUploadFiles} examid={examId}
                                        credname={credentialName}></c-upload-file>
                                </lightning-layout-item>

                            </lightning-layout>

                        </div>
                        <footer class="slds-modal__footer">
                            <lightning-button class="button" variant="neutral" label="Cancel" onclick={closeModal}>
                            </lightning-button>
                            <lightning-button variant="brand" label="Save" onclick={saveResult}>
                            </lightning-button>
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
            </template>
        </template>
        <!-- to show the image if there is no records -->
        <template if:true={showIcon}>
            <div class="slds-text-align_center imgAdjustment">
                <img src={Icn} aria-hidden="true" alt="Assignment Logo"></img>
            </div>
            <div class="slds-text-align_center">
                <h2>{label.ExamAttempt_EmptyMsg}</h2><br>
            </div>
        </template>
    </lightning-card>
</template>